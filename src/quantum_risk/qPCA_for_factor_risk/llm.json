{
    "task": "qpca_factor_risk_analysis_asset_level_evaluation_optimized",
  
    "design_principle": {
      "quantum_scope": "asset_level_only",
      "portfolio_projection": false,
      "rationale": "Quantum PCA (qPCA) is used to extract dominant latent factors from rolling-window return covariance structure for factor-driven risk analysis. Factors, explained variance, and factor-implied risk measures are computed per asset (via factor exposures derived from covariance eigenstructure) without portfolio aggregation. Outputs include time-series factor diagnostics, tail-risk implications (VaR/CVaR proxies from factor shocks), and quantum-specific complexity metrics to support IEEE Access-grade empirical comparison with classical PCA-based factor risk pipelines."
    },
  
    "inputs": {
      "panel_price_path": "data/preprocessed/panel_price.parquet",
      "asset_universe": {
        "mode": "from_columns",
        "include": null,
        "exclude": null
      },
      "factor_analysis_mode": {
        "type": "cross_asset_window_covariance",
        "notes": "qPCA requires a covariance/density-matrix object; factors are extracted from the cross-asset covariance on each rolling window. Asset-level reporting is produced by projecting each asset onto the extracted factors."
      }
    },
  
    "data_settings": {
      "return_type": "log",
      "tail_side": "left",
      "calendar": {
        "sort_index": true,
        "drop_duplicate_dates": true,
        "timezone": null
      },
      "missing_data_policy": {
        "dropna": "panel_intersection",
        "min_required_observations": 800,
        "min_required_assets_per_window": 20
      },
      "standardization": {
        "enabled": true,
        "method": "zscore",
        "fit_scope": "per_window_cross_asset",
        "winsorize_quantiles": [0.001, 0.999]
      }
    },
  
    "qpca_settings": {
      "method": "density_matrix_qpca",
      "eigen_solver": "quantum_phase_estimation_like",
      "top_k_components": [3, 5, 10],
      "explained_variance_target": 0.85,
  
      "estimation_windows": [252, 500],
  
      "rolling": {
        "enabled": true,
        "step_size": 5,
        "warmup_policy": "skip_until_window_full",
        "factor_series_mode": "rolling_time_series"
      },
  
      "density_matrix_construction": {
        "source": "sample_covariance",
        "covariance_type": "shrinkage",
        "shrinkage_method": "ledoit_wolf",
        "to_density_matrix": {
          "method": "trace_normalization",
          "numerical_stability_eps": 1e-10
        }
      },
  
      "random_seed": 42
    },
  
    "quantum_execution": {
      "state_preparation": {
        "method": "amplitude_encoding",
        "assumption": "qRAM_or_approx_state_prep",
        "notes": "In practice, simulate state preparation; for hardware, this corresponds to data-loading overhead that must be reported separately."
      },
  
      "phase_estimation": {
        "precision_bits": 6,
        "num_ancilla_qubits": 6,
        "max_eigenvalue_support": 1.0
      },
  
      "backend": "aer_simulator",
      "shots": 4000,
      "measurement_error_mitigation": false
    },
  
    "factor_risk_construction": {
      "factor_scores": {
        "method": "projection",
        "output": "per_asset_factor_exposure",
        "notes": "Asset exposures are computed by projecting each asset's return vector onto the qPCA factors in each window."
      },
  
      "factor_shock_scenarios": {
        "enabled": true,
        "shock_levels_sigma": [1, 2, 3],
        "combine_method": "single_factor_then_multifactor",
        "notes": "Compute factor-implied loss shocks per asset for stress and tail proxy analysis."
      },
  
      "risk_proxies": {
        "enabled": true,
        "confidence_levels": [0.95, 0.99],
        "methods": [
          "factor_gaussian_var",
          "factor_gaussian_cvar"
        ],
        "notes": "VaR/CVaR proxies derived from factor-implied distribution using factor covariance and idiosyncratic variance."
      }
    },
  
    "computation_strategy": {
      "compute_returns_once": true,
  
      "rolling_engine": {
        "vectorization": "per_window_cross_asset_then_project_to_assets",
        "parallelization_axis": ["time_window"],
        "max_workers": "auto",
        "chunk_windows": 1
      },
  
      "cache": {
        "enabled": true,
        "scope": "per_window_per_k_per_time_index",
        "store_format": "parquet",
        "parameter_store_path": "cache/qpca_window_parameters.parquet",
        "key_fields": [
          "date",
          "estimation_window",
          "top_k",
          "precision_bits",
          "shots",
          "shrinkage_method",
          "return_type"
        ],
        "write_mode": "append_or_upsert",
        "cache_hit_ratio_metric": true
      },
  
      "runtime_instrumentation": {
        "enabled": true,
        "measure": [
          "total_runtime_ms",
          "returns_compute_time_ms",
          "covariance_build_time_ms",
          "density_matrix_build_time_ms",
          "state_preparation_time_ms",
          "qpca_runtime_ms",
          "projection_time_ms",
          "factor_risk_compute_time_ms",
          "time_slicing_time_ms"
        ]
      },
  
      "safety_checks": {
        "enabled": true,
        "checks": [
          {
            "name": "density_matrix_psd",
            "rule": "min_eigenvalue >= -1e-8",
            "on_fail": "flag_and_continue"
          },
          {
            "name": "explained_variance_monotone",
            "rule": "explained_variance_k_increases_with_k",
            "on_fail": "flag_and_continue"
          },
          {
            "name": "finite_factor_exposures",
            "rule": "all(isfinite(exposures))",
            "on_fail": "skip_timestamp"
          }
        ]
      }
    },
  
    "evaluation": {
      "scope": "per_asset",
      "outputs_granularity": {
        "factor_level": true,
        "asset_exposure_series_level": true,
        "summary_level": true,
        "time_sliced_level": true
      },
  
      "factor_quality": {
        "enabled": true,
        "metrics": [
          "explained_variance_ratio",
          "cumulative_explained_variance",
          "factor_stability_cosine_similarity",
          "subspace_distance"
        ],
        "notes": "Compare factor subspaces across adjacent windows to assess regime shifts and stability."
      },
  
      "classical_alignment": {
        "enabled": true,
        "baseline": "classical_pca",
        "metrics": [
          "principal_angle_distance",
          "explained_variance_gap",
          "exposure_correlation"
        ]
      },
  
      "time_sliced_metrics": {
        "enabled": true,
        "slice_by": ["year", "quarter", "month"],
        "minimum_observations_per_slice": 30,
        "metrics": [
          "cumulative_explained_variance",
          "factor_stability_cosine_similarity",
          "principal_angle_distance",
          "exposure_correlation"
        ]
      }
    },
  
    "metrics": {
      "factor": [
        "explained_variance_ratio_k",
        "cumulative_explained_variance_k",
        "factor_stability_cosine_similarity",
        "subspace_distance",
        "principal_angle_distance_vs_classical"
      ],
  
      "asset_level_risk": [
        "factor_var_95",
        "factor_var_99",
        "factor_cvar_95",
        "factor_cvar_99",
        "idiosyncratic_variance"
      ],
  
      "quantum_specific": [
        "precision_bits",
        "num_ancilla_qubits",
        "shots",
        "qpca_circuit_depth",
        "qpca_circuit_width",
        "estimated_eigenvalues",
        "eigenvalue_ci_width"
      ],
  
      "runtime": [
        "total_runtime_ms",
        "runtime_per_window_ms",
        "mean_qpca_runtime_ms",
        "p95_qpca_runtime_ms",
        "state_preparation_time_ms",
        "cache_hit_ratio"
      ]
    },
  
    "outputs": {
      "window_parameter_store": {
        "path": "cache/qpca_window_parameters.parquet",
        "contents": [
          "date",
          "estimation_window",
          "top_k",
          "shrinkage_method",
          "density_matrix_trace",
          "estimated_eigenvalues",
          "explained_variance_ratio",
          "fit_success"
        ]
      },
  
      "factor_store": {
        "path": "results/quantum_risk/qpca_factor_series.parquet",
        "format": "parquet",
        "contents": [
          "date",
          "estimation_window",
          "top_k",
          "factor_id",
          "eigenvalue",
          "explained_variance_ratio",
          "cumulative_explained_variance"
        ]
      },
  
      "asset_exposure_store": {
        "path": "results/quantum_risk/qpca_asset_factor_exposures.parquet",
        "format": "parquet",
        "contents": [
          "asset",
          "date",
          "estimation_window",
          "top_k",
          "factor_id",
          "exposure"
        ]
      },
  
      "asset_factor_risk_store": {
        "path": "results/quantum_risk/qpca_asset_factor_risk_proxies.parquet",
        "format": "parquet",
        "contents": [
          "asset",
          "date",
          "confidence_level",
          "estimation_window",
          "top_k",
          "VaR_factor",
          "CVaR_factor",
          "idiosyncratic_variance"
        ]
      },
  
      "metrics_table": {
        "path": "results/quantum_risk/qpca_asset_level_metrics.parquet",
        "format": "parquet",
        "row_granularity": "asset_x_window_x_k",
        "notes": "Aggregated factor-quality and factor-risk proxy metrics per asset (via exposures) and qPCA configuration."
      },
  
      "time_sliced_metrics_table": {
        "path": "results/quantum_risk/qpca_asset_level_time_sliced_metrics.parquet",
        "format": "parquet",
        "row_granularity": "asset_x_slice_type_x_slice_value_x_window_x_k"
      },
  
      "report": {
        "path": "results/quantum_risk/qpca_asset_level_report.md",
        "include_sections": [
          "quantum_methodology_overview",
          "density_matrix_construction_and_shrinkage",
          "qpca_eigenspectrum_estimation",
          "factor_exposure_construction",
          "factor_risk_proxy_methodology",
          "factor_stability_and_regime_shifts",
          "classical_pca_alignment_results",
          "runtime_and_state_preparation_overhead",
          "key_insights"
        ]
      }
    },
  
    "paper_usage_notes": {
      "simulation_phase": "Use this configuration to extract rolling-window qPCA factors from cross-asset covariance and compute per-asset factor exposures and factor-implied risk proxies. Compare stability and explained variance to classical PCA baselines.",
      "paper_phase": "For paper results, highlight factor stability across regimes, explained variance concentration, and differences vs classical PCA. Report state-preparation overhead explicitly and discuss feasibility on near-term hardware."
    }
  }
  