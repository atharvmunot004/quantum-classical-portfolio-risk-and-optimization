{
  "task": "risk_parity_erc_optimization_ieee_access",

  "design_principles": {
    "scope": "portfolio_level_optimization",
    "risk_budgeting_paradigm": "equal_risk_contribution",
    "primary_objective": "minimize_risk_parity_deviation_under_constraints",
    "rationale": [
      "ERC (risk parity) constructs portfolios that equalize component contributions to total volatility, improving risk diversification without relying on expected return estimates.",
      "For IEEE Access-grade empirical rigor, the pipeline enforces rolling out-of-sample evaluation, multiple covariance estimators, constraint ablations, and statistical significance testing of performance differences."
    ],
    "reproducibility": {
      "random_seed": 42,
      "deterministic_backend": true,
      "version_logging": {
        "python": true,
        "numpy": true,
        "pandas": true,
        "scipy": true,
        "sklearn": true
      }
    }
  },

  "inputs": {
    "panel_price_path": "data/processed/panel_price.parquet",
    "baseline_portfolios_path": "portfolios/portfolios.parquet",
    "return_type": "log",
    "calendar": {
      "sort_index": true,
      "drop_duplicate_dates": true,
      "timezone": null
    },
    "missing_data_policy": {
      "mode": "per_portfolio_assets_intersection",
      "min_history_required": 756,
      "forward_fill_limit": 0,
      "drop_assets_if_insufficient_history": true
    }
  },

  "experiment_protocol": {
    "evaluation_mode": "rolling_out_of_sample",
    "rebalancing": {
      "frequency": "monthly",
      "transaction_cost_model": {
        "enable": true,
        "type": "linear",
        "bps_per_turnover": 10
      }
    },
    "rolling_windows": {
      "estimation_windows": [252, 500, 750],
      "warmup_policy": "skip_until_full_window"
    },
    "horizons_days": [1, 5, 10, 20],
    "confidence_levels": [0.95, 0.99],
    "baseline_comparators": [
      "baseline_portfolios_from_file",
      "equal_weight_same_assets",
      "min_variance_same_assets"
    ],
    "statistical_testing": {
      "enable": true,
      "tests": [
        "jobson_korkie_sharpe_difference",
        "memmel_sharpe_correction",
        "diebold_mariano_predictive_loss",
        "bootstrap_ci_metrics"
      ],
      "bootstrap": {
        "method": "stationary_block_bootstrap",
        "block_length": 10,
        "n_resamples": 2000,
        "ci_levels": [0.90, 0.95]
      }
    }
  },

  "risk_parity_settings": {
    "method": "equal_risk_contribution",
    "risk_measure": "volatility",
    "generalized_risk_budgeting": {
      "enable": true,
      "target_risk_budgets": "equal",
      "allow_custom_budget_vectors": false
    },

    "covariance_estimation": {
      "estimators": [
        {
          "name": "sample",
          "shrinkage": {
            "enable": true,
            "method": "ledoit_wolf"
          }
        },
        {
          "name": "oas",
          "shrinkage": {
            "enable": true,
            "method": "oas"
          }
        },
        {
          "name": "ewma",
          "params": {
            "lambda": 0.94
          }
        }
      ],
      "stability_checks": {
        "ensure_psd": true,
        "psd_fix": "eigenvalue_clipping",
        "min_eigenvalue": 1e-10,
        "condition_number_guard": {
          "enable": true,
          "max_condition_number": 1000000,
          "action_if_violated": "fallback_to_shrinkage"
        }
      }
    },

    "constraints": {
      "long_only": true,
      "fully_invested": true,
      "weight_bounds": [0.0, 1.0],
      "max_weight_per_asset": 0.25,
      "turnover_constraint": {
        "enable": true,
        "max_turnover_per_rebalance": 0.30
      }
    },

    "optimization": {
      "problem_formulation": "nonlinear_risk_budgeting",
      "objective": {
        "type": "risk_contribution_deviation",
        "loss": "squared",
        "normalization": "by_total_risk",
        "epsilon_for_numerical_stability": 1e-12
      },
      "solver_stack": [
        {
          "backend": "scipy",
          "solver": "slsqp",
          "tolerance": 1e-8,
          "max_iterations": 5000
        },
        {
          "backend": "scipy",
          "solver": "trust-constr",
          "tolerance": 1e-8,
          "max_iterations": 5000
        }
      ],
      "initialization": {
        "strategy": "feasible_equal_weight_then_project",
        "multi_start": {
          "enable": true,
          "n_starts": 5,
          "noise_scale": 0.02
        }
      },
      "convergence_and_failover": {
        "accept_if_kkt_residual_below": 1e-6,
        "fallback_if_fail": "previous_weights_or_equal_weight",
        "log_failure_reasons": true
      }
    }
  },

  "modules": {
    "compute_daily_returns": true,
    "compute_covariance_matrix": true,

    "calculate_risk_contributions": true,
    "run_risk_parity_optimizer": true,
    "extract_optimal_portfolio": true,

    "out_of_sample_backtest": true,
    "compute_portfolio_statistics": true,
    "compute_sharpe_ratio": true,
    "compute_sortino_ratio": true,
    "compute_max_drawdown": true,
    "compute_calmar_ratio": true,

    "risk_contribution_analysis": true,
    "covariance_sensitivity_analysis": true,
    "constraint_impact_analysis": true,

    "structure_metrics": [
      "hhi",
      "effective_number_of_assets",
      "weight_entropy",
      "pairwise_correlation_mean"
    ],

    "distribution_metrics": [
      "skew",
      "kurtosis",
      "jarque_bera"
    ],

    "risk_metrics": {
      "enable": true,
      "var_cvar": {
        "method": "historical",
        "enable_parametric_normal": true,
        "enable_parametric_student_t": true
      },
      "downside": {
        "downside_deviation": true,
        "semivariance": true
      }
    },

    "runtime_metrics": {
      "enable": true,
      "timers": [
        "returns_time_ms",
        "covariance_estimation_time_ms",
        "risk_contribution_time_ms",
        "solver_time_ms",
        "total_optimization_time_ms"
      ],
      "percentiles": [50, 90, 95, 99]
    },

    "diagnostics": {
      "enable": true,
      "store_intermediate_weights": false,
      "log_covariance_properties": [
        "is_psd",
        "min_eigenvalue",
        "condition_number"
      ],
      "log_solver_diagnostics": [
        "status",
        "message",
        "n_iters",
        "objective_value",
        "kkt_residual"
      ]
    }
  },

  "performance_metrics": {
    "portfolio_quality": [
      "annualized_return",
      "annualized_volatility",
      "annualized_variance",
      "sharpe_ratio",
      "sortino_ratio",
      "max_drawdown",
      "calmar_ratio",
      "turnover",
      "net_return_after_costs"
    ],

    "risk_parity_specific": [
      "risk_contribution_vector",
      "marginal_risk_contribution_vector",
      "risk_contribution_fraction_vector",
      "risk_contribution_variance",
      "risk_contribution_std",
      "risk_contribution_coefficient_of_variation",
      "max_risk_contribution_fraction",
      "min_risk_contribution_fraction",
      "equal_risk_gap_l1",
      "equal_risk_gap_l2",
      "risk_parity_deviation_score",
      "risk_concentration_index"
    ],

    "risk_metrics": [
      "value_at_risk_95_1d",
      "conditional_value_at_risk_95_1d",
      "value_at_risk_99_1d",
      "conditional_value_at_risk_99_1d",
      "downside_deviation",
      "semivariance"
    ],

    "structure": [
      "num_assets_in_portfolio",
      "hhi_concentration",
      "effective_number_of_assets",
      "weight_entropy",
      "pairwise_correlation_mean"
    ],

    "normality_checks": [
      "skewness",
      "kurtosis",
      "jarque_bera_p_value"
    ],

    "comparison_metrics": [
      "baseline_portfolio_annualized_volatility",
      "baseline_portfolio_sharpe",
      "baseline_portfolio_annualized_return",
      "volatility_reduction_vs_baseline",
      "sharpe_improvement_vs_baseline",
      "risk_parity_deviation_improvement_vs_baseline",
      "erc_vs_equal_weight_volatility",
      "erc_vs_equal_weight_sharpe",
      "erc_vs_equal_weight_risk_parity_deviation",
      "erc_vs_min_variance_volatility",
      "erc_vs_min_variance_sharpe"
    ],

    "statistical_significance": [
      "sharpe_diff_p_value_jobson_korkie",
      "sharpe_diff_p_value_memmel",
      "diebold_mariano_p_value",
      "bootstrap_ci_return",
      "bootstrap_ci_sharpe",
      "bootstrap_ci_drawdown"
    ],

    "runtime": [
      "runtime_per_optimization_ms",
      "p95_runtime_ms",
      "p99_runtime_ms",
      "covariance_estimation_time_ms",
      "risk_contribution_time_ms",
      "solver_time_ms",
      "total_optimization_time_ms"
    ]
  },

  "report_sections": [
    "methodology_overview",
    "risk_parity_and_erc_theory",
    "risk_budgeting_optimization_formulation",
    "covariance_estimation_and_psd_stability",
    "rolling_out_of_sample_backtest_protocol",
    "risk_contribution_results_and_deviation_analysis",
    "portfolio_quality_and_downside_risk_metrics",
    "comparative_results_vs_baselines",
    "robustness_sensitivity_and_constraint_ablations",
    "statistical_significance_and_confidence_intervals",
    "computational_complexity_and_runtime_profile",
    "key_insights_and_limitations"
  ],

  "outputs": {
    "optimal_portfolios": "results/classical_optimization/rp_erc_weights.parquet",
    "risk_contribution_table": "results/classical_optimization/rp_erc_risk_contributions.parquet",
    "metrics_table": "results/classical_optimization/rp_erc_metrics.parquet",
    "metrics_schema_json": "results/classical_optimization/rp_erc_metrics_schema.json",
    "diagnostics_json": "results/classical_optimization/rp_erc_diagnostics.json",
    "summary_report": "results/classical_optimization/rp_erc_report.md"
  }
}
